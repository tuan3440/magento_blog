<?php
/**
 * @var Hust\Service\Block\Locator\View $block
 */
$locator = $block->getLocator();
$hours = $block->getHours();
?>
<div class="container">
    <div class="title">Chọn thời gian và khung giờ sử dụng dịch vụ</div>
    <div class="info-store">
        <h3>Tên tiệm spa: <?= $locator->getName(); ?></h3>
        <div> ĐỊa chỉ : <?= $locator->getAddress(); ?></div>
        <div>Thành phố : <?= $locator->getCity(); ?></div>
        <div>Số điện thoại : <?= $locator->getPhone(); ?></div>
        <div class="calendar">
                <div class="field">
                    <label>Chọn ngày : </label>
                    <input type="text" class="input-text" id="example-date" style="width: auto"
                           name="date" data-validate="{required:true, 'validate-date':true}"/>
                </div>
            <?php
                 foreach ($hours as $key => $hour):
            ?>
                 <button value="<?=$key?>"><?= $hour?></button>
            <?php
                endforeach;
            ?>
                <br>
                <button id="booking" class="booking">Book</button>
        </div>
    </div>
</div>

<script type="text/x-magento-init">
    {
        "#form-booking": {
            "validation": {}
        }
    }
</script>

<!--<script type="text/javascript">-->
<!--    require([-->
<!--        'jquery',-->
<!--        "mage/url"-->
<!--    ], function ($, urlBuilder) {-->
<!--        $(document).ready(function () {-->
<!--            $('#example-date').change(function () {-->
<!--                var url = urlBuilder.build('bookings/locator/slot');-->
<!--                $.ajax({-->
<!--                    url: url,-->
<!--                    type: 'POST',-->
<!--                    dataType: 'json',-->
<!--                    data: {-->
<!--                        service_id: $("input[name='service_id']").val(),-->
<!--                        locator_id: $("input[name='locator_id']").val(),-->
<!--                        date: $("input[name='date']").val()-->
<!--                    },-->
<!--                    success: function (response) {-->
<!--                        console.log(response)-->
<!--                        $('#slot').html(response.slot)-->
<!--                    },-->
<!--                    error: function (xhr, status, errorThrown) {-->
<!--                        console.log('Error happens. Try again.');-->
<!--                    }-->
<!--                });-->
<!--            });-->
<!---->
<!--        });-->
<!--    })-->
<!--</script>-->

<style>
    .title {
        text-align: center;
        padding: 15px;
        background-color: #0053a0;
        font-size: 17px;
        color: white;
    }
    div#slot {
        margin-bottom: 10px;
        margin-top: 10px;
    }
    .info-store {
        width: 60%;
        margin: auto;
        line-height: 30px;
    }
    .calendar button {
        margin-left: 20px;
        margin-top: 20px;
    }


</style>

<script>
    require([
        'jquery',
        'mage/translate',
        'mage/calendar'
    ], function ($, $t) {
        $('#example-date').calendar({
            dateFormat: "d/M/yy",
            changeMonth: true,
            changeYear: true,
            showButtonPanel: true,
            currentText: $t('Go Today'),
            closeText: $t('Close'),
            showWeek: true
        });
    })
</script>

<div id="modal-booking-customer" style="display:none;">
    <form class="form form-booking-customer" action="<?php /* @escapeNotVerified */ echo $block->getUrl('bookings/locator/bookPost') ?>" method="post" id="form-validate" enctype="multipart/form-data" data-hasrequired="<?php /* @escapeNotVerified */ echo __('* Required Fields') ?>" autocomplete="off">
        <?php echo $block->getBlockHtml('formkey')?>
    </form>
</div>

<script type="text/javascript">
    require(['jquery', 'Magento_Ui/js/modal/modal', 'mage/mage'], function ($, modal) {
        $(document).ready(function () {
            $('#booking').on('click', function () {
                var options = {
                    type: 'popup',
                    modalClass: 'popup-change-profile',
                    title: 'Edit Account Information',
                    responsive: true,
                    buttons: [
                        {
                            text: 'Cancel',
                            class: 'action modal-cancel',
                            click: function () {
                                this.closeModal();
                            }
                        },
                        {
                            text: 'Save',
                            class: 'action save primary',
                            click: function () {

                                $('form.form.form-change-profile').submit();
                            }
                        }
                    ]
                };
                var popupAdd = modal(options, $('#modal-change-profile'));
                $('#modal-change-profile').modal('openModal');
            })
        });
    })
</script>

